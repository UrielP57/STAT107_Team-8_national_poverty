---
title: "11_DataCleaning"
output: html_document
---

# Data Cleaning for Project

This RMarkdown document is to clean the raw data, addressing missing observations, filtering variables of interest, and ensuring correct data types. The cleaned data will be saved as `11_dataclean.csv` for use in the analysis steps.

```{r}
library(stargazer)
library(car)
require(graphics)
library(readr)
ND <- read.csv("New_DDAY.csv")
API <- read.csv("API_A.csv")
Pop_Growth <- read.csv("Pop_Growth.csv")
unemployment <- read.csv("Unemployment.csv")
Education <- read.csv("Education.csv")
```

# Code for ND

```{r}
swappy_swappy <- function(df){
  row <- c() 
  mid <- c()
  not_imp <- c() #useless vector
  for (ind_row in rownames(df)){
    for (i in df[ind_row,]){
      RC <- as.character(i)
      if (is.na(RC)){
        RC <- 0
        row <- c(row, RC)
        
       } else {
         vari_RC <- suppressWarnings(as.numeric(RC))
                                        
                                        
          if (!is.na(vari_RC)){
            row <- c(row, RC)
            }  else if (RC != ""){
            not_imp <- c(not_imp, RC)
            }
      }
    }
  }
  df_by_65 <- rep(1:270, each = 65)
  fin <- split(row, df_by_65)
  return(fin)
}

```

# Data frame cleaning for Poverty Rate:
```{r}
fin_ND <- swappy_swappy(ND)
col_nm_all <- ND[,1][5:270]
df_ND <- data.frame(fin_ND[5:270])
colnames(df_ND) <- c(col_nm_all)
years <- c(1960:2024) 
rownames(df_ND) <- c(years)
df_ND$idea <- ifelse(df_ND$Aruba >= 0, 0)
for (idk in colnames(df_ND)){
  df_ND$idea <- as.numeric(df_ND$idea) + as.numeric(df_ND[[idk]])
  df_ND$Poverty_rate <- ifelse(df_ND$Aruba >= 0, df_ND$idea/ 270)
}
```

# Data Frame cleaning for Inflation:
```{r}
fin_API <- swappy_swappy(API)

col_nm_2 <- API[,1][5:270]
df_API <- data.frame(col_nm = fin_API[5:270])

colnames(df_API) <- c(col_nm_2)
rownames(df_API) <- c(years)
df_API$idea <- ifelse(df_API$Aruba >= -1, 0,0)
for (idk_2 in colnames(df_API)){
  df_API$idea <- as.numeric(df_API$idea) + as.numeric(df_API[[idk_2]])
  df_ND$`Inflation` <- ifelse(df_API$Aruba >= -1, df_API$idea/ 270, 0)
}
```

#Data Farme Cleaning for Population growth:
```{r}
fin_PG <- swappy_swappy(Pop_Growth)

col_nm_3 <- Pop_Growth[,1][5:270]
df_PG <- data.frame(col_nm = fin_PG[5:270])

colnames(df_PG) <- c(col_nm_3)
rownames(df_PG) <- c(years)
df_PG$idea <- ifelse(df_PG$Aruba >= -1, 0,0)
for (idk_3 in colnames(df_API)){
  df_PG$idea <- as.numeric(df_PG$idea) + as.numeric(df_PG[[idk_3]])
  df_ND$`Population` <- ifelse(df_PG$Aruba >= -10000,0, df_PG$idea/ 270)
}
```

#Data Frame Cleaning for Unemployment
```{r}
fin_unempo <- swappy_swappy(unemployment)

col_nm_4 <- unemployment[,1][5:270]
df_unemployment <- data.frame(fin_unempo[5:270])

colnames(df_unemployment) <- c(col_nm_4)
rownames(df_unemployment) <- c(years)

df_unemployment$idea <- ifelse(df_unemployment$Aruba >= -1, 0,0)
for (idk_4 in colnames(df_unemployment)){
  df_unemployment$idea <- as.numeric(df_unemployment$idea) + as.numeric(df_unemployment[[idk_4]])
  df_ND$`Unemployment` <- ifelse(df_unemployment$Aruba >= -10000,df_unemployment$idea/ 270,0)
}
```

#Data Frame Cleaning for Education % from GDP
```{r}
fin_ed <- swappy_swappy(Education)

col_nm_ed <- Education[,1][5:270]
df_ed <- data.frame(col_nm_ed = fin_ed[5:270])

colnames(df_ed) <- c(col_nm_ed)
rownames(df_ed) <- c(years)
df_ed$Education <- ifelse(df_ed$Aruba >= -1, 0,0)
for (idk_ed in colnames(df_ed)){
  df_ed$Education <- as.numeric(df_ed$Education) + as.numeric(df_ed[[idk_ed]])
  df_ND$`Education % from GDP` <- ifelse(df_ed$Aruba >= -10000,df_ed$Education/ 270)
}
```

```{r}
write.csv(df_ND, file = "11_dataclean.csv", row.names = TRUE)
```

